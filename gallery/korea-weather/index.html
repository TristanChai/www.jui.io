<!DOCTYPE HTML>
<html>
<head>
<META charset="UTF-8">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">

<link rel="stylesheet" href="../../lib/jui/css/ui.min.css" />
<link rel="stylesheet" href="../../lib/jui/css/ui-jennifer.min.css" />
<link rel="stylesheet" href="../../lib/jui/css/grid.min.css" />
<link rel="stylesheet" href="../../lib/jui/css/grid-jennifer.min.css" />
<script type="text/javascript" src="../../lib/jquery-1.8.0.min.js" ></script>
<script type="text/javascript" src="../../lib/jui/js/core.min.js" ></script>
<script type="text/javascript" src="../../lib/jui/js/ui.min.js" ></script>
<script type="text/javascript" src="../../lib/jui/js/grid.min.js" ></script>
<script type="text/javascript" src="../../lib/jui/js/chart.min.js" ></script>

<link rel="stylesheet" href="style.css" />

<script>
function windowResize() {
    var container = $('.jui');
    var $panel = $(".panel > .body");

    $(container).height(740);
    $('#weather-map').height(670);
}

jui.ready([ "util.base", "util.time", "chart.builder" ], function(_, time, builder) {
    windowResize();

    var weatherMapData = [{
        id: "서울",
        temperature: 25,
        weather: "cloudy",
        dx: 10
    }, {
        id: "인천",
        temperature: 28,
        weather: "sunny",
        dx: -50,
        dy: -25
    }, {
        id: "강원",
        temperature: 25,
        weather: "rain"
    }, {
        id: "충북",
        temperature: 26,
        weather: "rain",
        dx: 15
    }, {
        id: "충남",
        temperature: 22,
        weather: "sunny"
    }, {
        id: "전북",
        temperature: 26,
        weather: "murky"
    }, {
        id: "전남",
        temperature: 25,
        weather: "cloudy",
        dx: -20
    }, {
        id: "경북",
        temperature: 25,
        weather: "sunny"
    }, {
        id: "경남",
        temperature: 26,
        weather: "cloudy"
    }, {
        id: "제주",
        temperature: 24,
        weather: "murky",
        dx: -30,
        dy: -30
    }, {
        id: "울릉",
        temperature: 25,
        weather: "murky",
        dx: -40,
        dy: -20
    }];

    var englishProvincesData = {
        '서울': 'Seoul',
        '인천': 'Incheon',
        '강원': 'Gangwon',
        '충북': 'North Chungcheong',
        '충남': 'South Chungcheong',
        '전북': 'North Jeolla',
        '전남': 'South Jeolla',
        '경북': 'North Gyeongsang',
        '경남': 'South Gyeongsang',
        '제주': 'Jeju',
        '울릉': 'Ulleung',
    }

    function generateProvincesTemperature() {
        var data = [];

        Object.keys(englishProvincesData).map(function(key){
            data.push({
                name: englishProvincesData[key],
                Average: Math.floor(Math.random() * 10) + 30,
                Maximum: Math.floor(Math.random() * 10) + 35,
            });
        });

        return data;
    }

    var weatherMap = builder('#weather-map', {
        padding : 0,
        axis : [{
            map : {
                path : "../../lib/jui/img/map/korea-500x650.svg",
                width : 500,
                height : 650
            },
            data : weatherMapData
        }],
        brush : [{
            type : "map.weather",
            format : function(id) {
                return englishProvincesData[id];
            }
        }],
        style : {
            mapPathBackgroundColor : "white",
            mapPathBorderColor : "#a9a9a9"
        }
    });

    var weatherBar = builder("#weather-bar", {
        padding: {
            left: 0,
            right: 20,
            top: 20,
            bottom: 40
        },
        axis : {
            x : {
                type : "block",
                domain : "name",
                line : true
            },
            y : {
                type : "range",
                domain : [0, 50],
                step : 5,
                line : true,
                min: 0,
                orient : "right"
            },
            area: {
                // height: '100%',
            },
            data: generateProvincesTemperature()
        },
        brush : {
            type : "column",
            target : [ "Average", "Maximum" ]
        },
        widget : [
            { type : "tooltip" },
            { type : "legend" }
        ],
    });



    _.resize(windowResize, 100);
});
</script>
</head>
<body class="jui">
<div class="row">
    <div class="col" style="width: 550px; float:left;">
        <div class="panel">
            <div class="head">
                <strong>Korea Weather Map</strong>
            </div>
            <div class="body">
                <div id="weather-map"></div>
            </div>
        </div>
    </div>
    <div style="left: 2%; width: auto; overflow: hidden;">
        <div class="row">
            <div class="panel" style="width: 100%; ">
                <div class="head">
                    <strong>Temperature in each province</strong>
                </div>
                <div class="body" >
                    <div id="weather-bar" style="height: 120px"></div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="panel">
                <div class="head">
                    <strong>Visitor status</strong>
                </div>
                <div class="body">
                    <div id="status"></div>
                </div>
            </div>
        </div>
    </div>
</div>
</body>
</html>