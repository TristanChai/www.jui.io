<!DOCTYPE HTML>
<html>
<head>
<META charset="UTF-8">
<meta name="viewport" content="initial-scale=1, maximum-scale=1">
<link rel="stylesheet" href="../../lib/jui/css/ui.min.css" />
<link rel="stylesheet" href="../../lib/jui/css/ui-jennifer.min.css" id="ui_theme" />
<script type="text/javascript" src="../../lib/jquery-1.8.0.min.js" ></script>
<script type="text/javascript" src="../../lib/jui/js/core.js" ></script>
<script type="text/javascript" src="../../lib/jui/js/ui.min.js" ></script>
<script type="text/javascript" src="../../lib/jui/js/chart.js" ></script>
<link rel="stylesheet" href="../../gallery/gps/main.css" />
<script src="../../gallery/gps/resources/model/f16.js"></script>
<script src="../../gallery/gps/resources/model/dodge.js"></script>
<script src="../../gallery/gps/resources/model/hind.js"></script>
<script>
jui.define("chart.widget.radar", ["util.math"], function(math) {

	var Radar = function () {
		var g, guid, line, tail;
		var circle, circle2;
		var angle = 0;
		var tail_length = 50;
		var tail_size = 5;
		var self = this;
		this.drawBefore = function () {
			g = this.svg.g({
				'class' : 'radar'
			});


			guide = this.svg.g({
				'class' : 'radar-guide'
			});

			g.append(guide);

			line = this.svg.path({
				'stroke-width' : 2,
				'stroke' : '#fff'
			});

			guide.append(line)

			tail = this.svg.path({
				'fill' : this.chart.color('linear(left) #fff,20% #fff,100% black'),
				'fill-opacity' : 0.1,
				'filter' : 'url(#blurFilter)',
				'stroke-width' : 0,
				'stroke' : 'transparent'
			});

			guide.append(tail);

			circle = this.svg.circle({
				fill : "#fff",
				"fill-opacity": 0.7,
				stroke : '#fff',
				cx : 0,
				cy : 0,
				r : 10
			});

			guide.append(circle);

			circle2 = this.svg.circle({
				fill : "#fff",
				cx : 0,
				cy : 0,
				r : 4
			});

			guide.append(circle2);

			var filter = this.svg.filter({
				id : "blurFilter",
				x : 0,
				y : 0
			});

			filter.append(this.svg.feGaussianBlur({
				in : "SourceGraphic",
				stdDeviation: 7
			}));

			this.chart.appendDefs(filter);
		}

		this.updateGuide = function () {



			guide.rotate(angle);

		}

		this.updateTail = function () {

			var w= this.axis.area('width');
			var h = this.axis.area('height');

			var r = Math.min(w, h)/2;

			line.MoveTo(0, 0);
			line.lineTo(0, r);
			line.join();

			var size = Math.floor(r / 5)/4 ;

			tail.MoveTo(0, 0);
			tail.lineTo(tail_length-tail_size, 0);

			var unit = tail_length/size;

			for(var i = 0; i < size; i++) {
				var start = i * unit;
				tail.qCurveTo(start, tail_size, 0, tail_size*2);
				tail.qCurveTo(-start, tail_size, 0, tail_size*2);
			}

			tail.lineTo(-tail_length-tail_size, 0);
			tail.closePath();
			tail.join();
		}

		this.draw = function () {

			var w= this.axis.area('width');
			var h = this.axis.area('height');

			var r = Math.min(w, h)/2;

			var startPosX = w/2 + this.chart.padding('left');
			var startPosY = h/2 + this.chart.padding('top');

			guide.translate(startPosX, startPosY);

			self.updateTail();

			clearInterval(window.timer);
			window.timer = setInterval(function() {

				angle = angle + 0.7;

				if (angle >= 360)
				{
					angle = 0;
				}

				self.updateGuide();

			}, 1000/60);


			return g;
		}
	}


	return Radar;

}, "chart.widget.core");
</script>
</head>
<body class="jui">

<div class="background"></div>

<div class="left-1 layer">
	<div class="city">Paju <img src="../../gallery/gps/resources/image/weather.svg" class="weather" /></div>
	<div class="location">Kyeongki-Do, South Korea</div>
	<div class="temp">20℃</div>
</div>
<div class="left-2 layer card"></div>
<div class="left-3 layer card"></div>
<div class="left-4 layer card"></div>

<div class="title">
	<div class="date">Friday, March 25</div>
	<div class="time">14:26:15</div>
</div>
<div id="radar"></div>

<div class="right-1 layer card"></div>
<div class="right-2 layer card"></div>
<div class="right-3 layer card"></div>

<script>
    jui.ready(function() {

		var color = jui.include('util.color');
		var c = color.scale().domain('rgb(38,173,32)', 'rgb(0,25,0)');


		// 맵 적용
		var names = {
			KR: "Korea",
			CN: "China",
			JP: "Japan"
		}

		var data = [{
			id: "KR",
			value: 50220000,
			texts: [
				"50.22 million people in 2013",
				"47.01 million people in 2000",
				"45.95 million people in 1997"
			]
		}, {
			id: "CN",
			value: 1357000000,
			texts: [
				"13.57 billion people in 2013",
				"12.63 billion people in 2000",
				"12.3 billion people in 1997"
			]
		}, {
			id: "JP",
			value: 127300000,
			texts: [
				"1.273 billion people in 2013",
				"1.269 billion people in 2000",
				"1.261 billion people in 1997"
			]
		}];

		var colors = c.ticks(3);

		var style = {
			backgroundColor: "transparent",
			gridAxisBorderColor : "#fff",
			gridBorderColor : "#fff",
			gridBorderWidth: 1,
			mapPathBackgroundColor: "#fff",
			mapPathBackgroundOpacity: 0.1,
			mapPathBorderColor: "#fff",
			mapPathBorderWidth: 0.5,
			mapControlButtonColor: "#ffcb2b",
			mapMinimapPathBackgroundColor: "#fff",
			mapMinimapPathBackgroundOpacity: 0.5,
			mapMinimapDragBackgroundColor: "transparent",
			mapMinimapDragBorderColor: "transparent",
			mapMinimapBorderWidth : 0.5,
			mapMinimapPathBorderWidth : 0.1
		}

		var domain = [];

		for(var i = 0; i < 360; i += 30) {
			domain.push(i);
		}

        var chart = jui.include("chart.builder");
        var data = [
            { type : "STR", warrior : 100, wizard : 30, archer : 35 },
            { type : "VIT", warrior : 80, wizard : 50, archer : 70 },
            { type : "DEX", warrior : 50, wizard : 70, archer : 95 },
            { type : "AGI", warrior : 70, wizard : 60, archer : 75 },
            { type : "INT", warrior : 30, wizard : 100, archer : 30 },
            { type : "WIS", warrior : 50, wizard : 90, archer : 40 }
        ];

		var map_data = [{
			id: "KR",
			airport: "small"
		}, {
			id: "GB",
			airport: "small"
		}, {
			id: "IE",
			airport: "small"
		}, {
			id: "PT",
			airport: "small"
		}, {
			id: "ES",
			airport: "small"
		}, {
			id: "FR",
			airport: "small"
		}, {
			id: "SE",
			airport: "small"
		}, {
			id: "UA",
			airport: "small"
		}, {
			id: "IT",
			airport: "small"
		}, {
			id: "IE",
			airport: "small"
		}, {
			id: "NO",
			airport: "small"
		}, {
			id: "GR",
			airport: "small"
		}, {
			id: "LT",
			airport: "small"
		}];

        var mainChart = chart("#radar", {
			theme : "dark",
			width: "100%",
			height: 830,
			padding : {
				top : 180,
				bottom : 60,
				left : 0,
				right : 0
			},
            axis : [
			{
				map : {
					path : "../../lib/jui/img/map/world-1040x660.svg",
					width : 1040,
					height : 660,
					scale : 4,
					viewX : -700,
					viewY : 100
				},
				data : map_data
			},{
				c : {
					type : "radar",
					shape : "circle",
					domain : domain,
					line : true
				},
				data : data
			}],
			brush : [{
				type : "map.flightroute",
				colors : jui.include("util.color").map.jet(2)
			}],
			widget : [{
				type : 'radar'
			},
			{
				type : "map.minimap",
				scale : 0.2,
				align : "end",
				orient : "top",
				dx : -65,
				dy : 38
			}],
			style : style,
			event : {
				render : function () {
					mapClip();
				}
			}

        });

		mapClip();


		function mapClip() {
			var clipPath = mainChart.svg.clipPath({
				id : 'map-clip'
			});

			var area = mainChart.axis(0).area();
			var size = Math.min(area.width, area.height);


			var clipCircle = mainChart.svg.circle({
				cx : area.width/2,
				cy : area.height/2,
				r  : size/2,
				fill : 'black'
			});



			var defs = mainChart.svg.root.element.children[0].children[0];

			clipPath.append(clipCircle);
			clipPath.element.appendChild(clipCircle.element);

			mainChart.appendDefs(clipPath);
			defs.appendChild(clipPath.element);



			mainChart.axis(0).map.root.attr({
				'clip-path' : 'url(#map-clip)'
			});

			var g = mainChart.svg.root.element.children[0].children[6];
			g.setAttribute('clip-path', 'url(#map-clip)');
		}


		function create (max) {
			return Math.floor(Math.random() * max % 100);
		}

		// modeling 객체 렌더링
		var f16 = chart("#chart6 .container", {
			width:300,
			height:200,
			padding : 0,
			axis : {
				x : {
					type : "range",
					domain : [ -5, 20 ],
					hide : true
				},
				y : {
					type : "range",
					domain : [ -3, 5 ],
					hide : true
				},
				z : {
					type : "range",
					domain : [ -7, 7 ],
					hide : true
				},
				degree : {
					x: 0,
					y: 0,
					z: 0
				},
				depth : 400,
				perspective : 0.8
			},
			brush : {
				type : "canvas.model3d",
				model : "f16"
			},
			widget : {
				type : "polygon.rotate3d"
			},
			style : {
				backgroundColor: 'transparent',
				gridXAxisBorderWidth: 1,
				gridYAxisBorderWidth: 1,
				gridZAxisBorderWidth: 1
			},
			canvas : true
		});


		var f16Y = 0;

		function startF16() {
			stopF16();
			f16.timer = setInterval(function() {
				(f16Y += 10);
				if (f16Y > 360) {
					f16Y = 0;
				}


				f16.axis(0).set('degree', {
					y : f16Y
				});
			}, 200);
		}

		function stopF16() {
			clearInterval(f16.timer);
		}

		//startF16();

		// modeling 객체 렌더링
		var hind = chart("#chart7 .container", {
			width:300,
			height:200,
			padding : 0,
			axis : {
				x : {
					type : "range",
					domain : [ -10, 10 ],
					hide : true
				},
	            y : {
					type : "range",
					domain : [ -5, 20 ],
					hide : true
				},
				z : {
					type : "range",
					domain : [ -7, 7 ],
					hide : true
				},
				degree : {
					x: 180,
					y: 0,
					z: 90
				},
				depth : 400,
				perspective : 0.8
			},
			brush : {
				type : "canvas.model3d",
				model : "hind" ,
				colors : ['green']
			},
			widget : {
				type : "polygon.rotate3d"
			},
			style : {
				backgroundColor: 'transparent',
				gridXAxisBorderWidth: 1,
				gridYAxisBorderWidth: 1,
				gridZAxisBorderWidth: 1
			},
			canvas : true,
			render : false
		});

		var hindY = 0;

		function startHind() {
			stopHind();
			hind.timer = setInterval(function() {
				(hindY += 10);
				if (hindY > 360) {
					hindY = 0;
				}


				hind.axis(0).set('degree', {
					y : hindY
				});
			}, 200);
		}

		function stopHind() {
			clearInterval(hind.timer);
		}

		//startHind();

		// modeling 객체 렌더링
		var dodge = chart("#chart8 .container", {
			width:300,
			height:200,
			padding : 0,
			axis : {
				x : {
					type : "range",
                domain : [ -10, 10 ],
					hide : true
				},
	            y : {
					type : "range",
	                domain : [ -5, 5 ],
					hide : true
				},
				z : {
					type : "range",
	                domain : [ -7, 7 ],
					hide : true
				},
				degree : {
					x: 0,
					y: 0,
					z: 0
				},
				depth : 400,
				perspective : 0.8,
			},
			brush : {
				type : "canvas.model3d",
				model : "dodge"
			},
			widget : {
				type : "polygon.rotate3d"
			},
			style : {
				backgroundColor: 'transparent',
				gridXAxisBorderWidth: 1,
				gridYAxisBorderWidth: 1,
				gridZAxisBorderWidth: 1
			},
			canvas : true,
			render : false
		});
		var dodgeY = 0;

		function startDodge() {
			stopDodge();
			dodge.timer = setInterval(function() {
				(dodgeY += 10);
				if (dodgeY > 360) {
					dodgeY = 0;
				}


				dodge.axis(0).set('degree', {
					y : dodgeY
				});
			}, 200);
		}

		function stopDodge() {
			clearInterval(dodge.timer);
		}

		//startDodge();


		var start_list = [ startF16, startHind, startDodge];
		var end_list = [ stopF16, stopHind, stopDodge];
		var id_list = [ '#chart6', '#chart7', '#chart8'];
		var chart_list = [f16, hind, dodge];


		function nextModeling() {
			var i = create(3);

			$("#chart6,#chart7,#chart8").removeClass('on');
			$(id_list[i]).addClass('on');

			chart_list[i].render();
			start_list[i].call();

			setTimeout(function() {
				end_list[i].call();

				nextModeling();
			}, 10000);
		}

		//setTimeout(nextModeling, 1000);
    });
</script>
</body>
</html>
